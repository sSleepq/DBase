# Функция SUBSTRING_INDEX в SQL

## Описание


Функция **SUBSTRING_INDEX** возвращает подстроку из строки до *N*-го вхождения указанного разделителя.


- Если *N* **положительно**, возвращается часть строки **слева** от последнего разделителя (счёт слева направо).
- Если *N* **отрицательно**, возвращается часть строки **справа** от последнего разделителя (счёт справа налево).


## Синтаксис

```sql
SELECT SUBSTRING_INDEX(поле, разделитель, количество_разделителей)
FROM имя_таблицы
WHERE условие;
```

## Пример таблицы

Таблица `texts`:


| id (айди) | text (текст) |
|-----------|-------------|
| 1 | слово1-слово2-слово3-слово4-слово5 |
| 2 | word1-word2-word3-word4-word5 |


## Примеры использования

### Пример 1. Подстрока до первого вхождения разделителя


**Задача:** вернуть часть строки до первого символа `-`.


**SQL‑запрос:**
```sql
SELECT *, SUBSTRING_INDEX(text, '-', 1) AS text FROM texts;
```

**Результат:**

| id (айди) | text (текст) |
|-----------|-------------|
| 1 | слово1 |
| 2 | word1 |

### Пример 2. Подстрока до второго вхождения разделителя


**Задача:** вернуть часть строки до второго символа `-`.

**SQL‑запрос:**
```sql
SELECT *, SUBSTRING_INDEX(text, '-', 2) AS text FROM texts;
```

**Результат:**

| id (айди) | text (текст) |
|-----------|-------------|
| 1 | слово1-слово2 |
| 2 | word1-word2 |


### Пример 3. Подстрока до третьего вхождения разделителя


**Задача:** вернуть часть строки до третьего символа `-`.
**SQL‑запрос:**
```sql
SELECT *, SUBSTRING_INDEX(text, '-', 3) AS text FROM texts;
```

**Результат:**

| id (айди) | text (текст) |
|-----------|-------------|
| 1 | слово1-слово2-слово3 |
| 2 | word1-word2-word3 |


### Пример 4. Подстрока от первого с конца вхождения разделителя


**Задача:** вернуть часть строки после последнего символа `-` (считая с конца).
**SQL‑запрос:**
```sql
SELECT *, SUBSTRING_INDEX(text, '-', -1) AS text FROM texts;
```

**Результат:**

| id (айди) | text (текст) |
|-----------|-------------|
| 1 | слово5 |
| 2 | word5 |


### Пример 5. Подстрока от второго с конца вхождения разделителя


**Задача:** вернуть часть строки после предпоследнего символа `-` (считая с конца).
**SQL‑запрос:**
```sql
SELECT *, SUBSTRING_INDEX(text, '-', -2) AS text FROM texts;
```

**Результат:**

| id (айди) | text (текст) |
|-----------|-------------|
| 1 | слово4-слово5 |
| 2 | word4-word5 |


### Пример 6. Подстрока от третьего с конца вхождения разделителя


**Задача:** вернуть часть строки после третьего с конца символа `-`.
**SQL‑запрос:**
```sql
SELECT *, SUBSTRING_INDEX(text, '-', -3) AS text FROM texts;
```

**Результат:**

| id (айди) | text (текст) |
|-----------|-------------|
| 1 | слово3-слово4-слово5 |
| 2 | word3-word4-word5 |


## Важные замечания


1. **Чувствительность к регистру:**  
   - Функция выполняет поиск разделителя с учётом регистра.


2. **Отсутствие разделителя:**  
   - Если разделитель не найден, возвращается исходная строка целиком.


3. **Нулевое значение N:**  
   - Использование `0` в качестве количества разделителей вернёт пустую строку.


4. **Многобайтовые разделители:**  
   - В качестве разделителя можно использовать строку любой длины (не только одиночный символ).


5. **Применение в реальных задачах:**  
   - Разбиение email‑адресов на имя и домен (`SUBSTRING_INDEX(email, '@', 1)`);
   - Обработка путей к файлам;
   - Парсинг CSV‑подобных данных в строках.
