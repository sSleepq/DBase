# Практическая работа #13

## Исходные данные

Для выполнения работы используются следующие таблицы.

**Таблица `customers` (клиенты):**

| id  | name  | email           | registration_date |
|-----|-------|-----------------|-------------------|
| 1   | John  | john@gmail.com  | 2017-03-30        |
| 2   | Max   | max@gmail.com   | 2023-05-29        |
| 3   | Carol | carol@gmail.com | 2021-02-28        |
| 4   | Nuno  | nuno@gmail.com  | 2020-09-25        |
| 5   | Ella  | ella@gmail.com  | 2018-03-30        |

**Таблица `orders` (заказы):**

| id  | customer_id | order_date | total_amount |
|-----|-------------|------------|--------------|
| 1   | 1           | 2017-12-12 | 450          |
| 2   | 2           | 2023-10-01 | 5000         |
| 3   | 3           | 2021-03-03 | 1500         |
| 4   | 5           | 2023-01-04 | 670          |
| 5   | 3           | 2023-01-30 | 5999         |
| 6   | 2           | 2023-07-03 | 300          |
| 7   | 1           | 2021-04-05 | 4111         |
| 8   | 3           | 2021-05-13 | 3124         |
| 9   | 2           | 2023-10-29 | 10000        |
| 10  | 1           | 2017-12-25 | 650          |

---

## Задания

### Задание 1. Определение самого активного клиента по сумме покупок
Напишите SQL-запрос, который определяет клиента (или клиентов) с наибольшей общей суммой всех заказов. Выведите имя клиента и общую сумму его заказов.

**Технические требования:**
1. Используйте агрегатную функцию `SUM()` для расчета общей суммы.
2. Используйте операторы `JOIN`, `GROUP BY` и `ORDER BY`.
3. Учтите, что клиентов с одинаковой максимальной суммой может быть несколько.
4. Для определения максимума можно использовать подзапрос с `MAX()` или `LIMIT`.

**Ожидаемый результат:** Список клиентов (возможно, один), у которых общая сумма заказов максимальна среди всех клиентов.

---

### Задание 2. Анализ последней активности клиентов
Напишите SQL-запрос, который выводит для каждого клиента, совершавшего заказы, его имя и дату последнего заказа. Список отсортируйте по имени клиента в алфавитном порядке.

**Технические требования:**
1. Для каждого клиента необходимо определить самую позднюю дату заказа (`order_date`).
2. Используйте агрегатную функцию `MAX()` для определения даты.
3. В запросе должны присутствовать операторы `JOIN`, `GROUP BY` и `ORDER BY`.
4. Клиенты без заказов в результат не включаются.

**Ожидаемый результат:** Таблица с двумя столбцами: `customer_name` и `last_order_date`.
