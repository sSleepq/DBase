# Практическая работа №17»

## Основная информация
- **Тема:** Сложные JOIN-запросы, агрегация и оконные функции в реляционных базах данных с многими-ко-многим
- **Цель работы:** Освоение методов работы со связями многие-ко-многим через соединительные таблицы, применение агрегатных и оконных функций для анализа многомерных данных.

## Исходные данные

Для выполнения работы используются следующие таблицы.

**Таблица `authors` (авторы):**

| id  | first_name | last_name |
|-----|------------|-----------|
| 1   | Jack       | Brown     |
| 2   | John       | Doe       |
| 3   | Max        | White     |


**Таблица `tags` (теги):**

| id  | name        |
|-----|-------------|
| 1   | IT          |
| 2   | PHP         |
| 3   | JavaScript  |
| 4   | React       |
| 5   | Angular     |
| 6   | Vue.js      |
| 7   | C/C++       |
| 8   | Rust        |

**Таблица `posts` (посты):**

| id  | title                       | likes | author_id |
|-----|-----------------------------|-------|-----------|
| 1   | Lorem ipsum                 | 3810  | 2         |
| 2   | Lorem ipsum dolor sit amet  | 1913  | 2         |
| 3   | Lorem ipsum dolor sit       | 4111  | 1         |
| 4   | Lorem ipsum dolor           | 6700  | 3         |

**Таблица `post_tag` (связь многие-ко-многим):**

| id  | post_id | tag_id |
|-----|---------|--------|
| 1   | 1       | 1      |
| 2   | 1       | 2      |
| 3   | 1       | 3      |
| 4   | 1       | 4      |
| 5   | 1       | 5      |
| 6   | 2       | 7      |
| 7   | 2       | 6      |
| 8   | 2       | 5      |
| 9   | 2       | 1      |
| 10  | 2       | 3      |
| 11  | 3       | 1      |
| 12  | 3       | 7      |
| 13  | 3       | 5      |
| 14  | 3       | 6      |
| 15  | 4       | 5      |
| 16  | 4       | 1      |
| 17  | 4       | 7      |
| 18  | 4       | 6      |

---

## Задания

### Задание 1. Найти наиболее продуктивного автора по количеству постов с тегами
Найдите автора, у которого наибольшее количество постов с тегами. Выведите:
- `author_name` (полное имя автора в формате "Имя Фамилия")
- `posts_count` (количество его постов, имеющих хотя бы один тег)
- `post_titles` (список заголовков этих постов через запятую)

**Технические требования:**
1. Учтите, что пост считается "постом с тегами", если у него есть хотя бы одна запись в таблице `post_tag`.
2. Используйте агрегатную функцию `COUNT(DISTINCT ...)` для подсчета уникальных постов.
3. Для объединения заголовков постов в одну строку используйте функцию `STRING_AGG()` (PostgreSQL) или `GROUP_CONCAT()` (MySQL).
4. Результат должен содержать только одного автора (или нескольких, если у них одинаковое максимальное количество постов).
5. Для отбора автора с максимальным количеством используйте оконную функцию `RANK()` или подзапрос с `MAX()`.

---

### Задание 2. Найти наиболее популярные теги среди различных авторов
Найдите теги, которые встречаются в постах наибольшее количество раз от различных авторов. Выведите:
- `tag_name` (название тега)
- `unique_authors_count` (количество уникальных авторов, использовавших этот тег в своих постах)
- `authors_list` (список имен этих авторов в формате "Имя Фамилия" через запятую)

**Технические требования:**
1. Уникальность авторов для каждого тега определяется по `author_id`.
2. Тег считается "использованным автором", если существует хотя бы один пост этого автора, помеченный данным тегом.
3. Используйте `COUNT(DISTINCT ...)` для подсчета уникальных авторов.
4. Для объединения имен авторов используйте `STRING_AGG()` или `GROUP_CONCAT()`.
5. Результат должен содержать теги с максимальным количеством уникальных авторов (может быть несколько тегов с одинаковым значением).
6. Для определения максимального количества используйте оконную функцию `RANK()` или `DENSE_RANK()` с `PARTITION BY`.
